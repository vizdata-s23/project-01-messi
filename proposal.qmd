---
title: "The Evolution of the World Cup"
subtitle: "Proposal"
format: html
editor: visual
---

```{r}
#| label: load-pkgs
#| message: false
#| warning: false

library(tidyverse)
```

# Dataset

The data covers every single World Cup match played in its history from Uruguay in 1930 to Russia in 2018. Our data is split into two datasets: `wcmatches` and `worldcups` .

In the `wcmatches` dataset, columns include `city` from which city was the match being played in, `outcome` which team claimed victory or did the match result in a draw, `win_conditions` showing if the winning side need added extra time or penalties to win the game.

In addition, the `worldcups` dataset includes a summary of each World Cup held, containing columns `winners`, `games`, `goals_scored`, and more.

We might include possible [data](https://www.kaggle.com/datasets/die9origephit/fifa-world-cup-2022-complete-dataset) from the Qatar World Cup with this link.

### Why We Picked this Dataset

We picked this dataset because we thought that the subject would be fresh on people's minds (the 2022 World Cup concluded less than two months ago), and therefore relevant to current discussion. We also felt that there has been a narrative in recent years about how the teams previously considered as "underdogs", have been catching up to the traditional powerhouse teams. We wanted to see if this narrative was in fact true, or if this was just wishful thinking. We were also curious to see if the penalties being implemented in the World Cup impacted the number of goals scored per game. We liked how the data included a dataset that looked at the World Cup at more of a macro level (one observation per world cup), and then also at a micro level (every individual match).

### Load Data

```{r}
#| label: load-data
#| message: false

wcmatches <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/wcmatches.csv')
worldcups <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/worldcups.csv')
```

The `wcmatches` dataset has `r nrow(wcmatches)` observations and `r ncol(wcmatches)` variables. Each observation represents a different match played at a world cup.

The `worldcups` dataset has `r nrow(worldcups)` observations and `r ncol(worldcups)` variables. Each observation represents a world cup.

# Questions

#### Question 1:

How have the goals per game and per tournament changed over time? Has the introduction of any new rules affected scores?

#### Question 2:

How has the representation of countries outside of Europe and South America changed over time? Has this changed by round?

# Analysis plan

**Merge Data**

First, we merged the `wcmatches` dataset with the `worldcups` dataset by left joining `worldcups` onto `wcmatches` by the year and bring over the information for each world cup to each world cup match.

**Note**: We might possibly merge external data for 2022 World Cup if we decide to include data from the recent World Cup into our analysis.

```{r}
#| label: merge-data

world_cup_total <- wcmatches |>
  left_join(worldcups, by = "year")
```

**Create New Variables**

We created three variables initially to help us explore our first question. `goalspergame` is the number of goals scored per game. `attendancepergame` is the attendance of people per game. `gamesperteam` is the number of games played per team. In addition to these variables, we will also create other variables that will explore different factors that affect the goals scored per game, including variables that represent certain changes like VAR that were implemented in the world cup.

```{r}
#| label: create-variables

world_cup_total <- world_cup_total |>
  mutate(goalspergame = goals_scored/games,
         attendancepergame = attendance/games,
         gamesperteam = games/teams)
```

To answer our second question, we will create a variable that calculates the proportion of teams from Europe/South American and other continents over each year of the world cup to use in our visualization and observe how this proportion changes over time.

### Question #1 Plan:

There have been new additions to world cup rules over time. This includes the introduction of penalties to break ties, VAR to contest calls on the field, the number of teams in each world cup, and more. There are also factors that affect the players individually, such as the number of additional leagues/tournaments they play in. 

We are **planning** to have a graph over time showing the number of goals scored during each world cup and/or during each game. We will add layers on top of this graph to show when certain changes were implemented in the world cup. Our overall goal is to analyze how games have changed over time in terms of goals scored. Higher scoring games indicate many things about the way teams are playing, and this could be due to the factors we will consider in our graphs. The variables we intend to use are year, home score, away score, and possibly extra variables we create.

### Question #2 Plan:

Back during the conception of the world cup, despite the 'world' name, it was dominated by European and South American teams. The world cup had very little representation from Asia, Africa and Oceania. We hope to make a graph which can explore this question on representation. 

We **plan** to make a graph which records the proportion of teams from Europe/South American and other over each year of the world cup. It would also be interesting to facet this by round so we can see if a potential increase in representation in early rounds leads to more representation in later rounds (with later rounds being the 'better' teams as it is an elimination tournament.

The graph we intend to use is a line graph. For this line graph, the x-axis will be year, the y-axis will be proportion, and color will be continent. We can also facet this by round.
